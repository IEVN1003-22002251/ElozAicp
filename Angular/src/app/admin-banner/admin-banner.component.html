<div class="admin-banner-container">
  <header class="admin-header">
    <h1 class="admin-title">Gestión de Recados y Avisos</h1>
    <button class="btn-back" (click)="goBack()">← Volver</button>
  </header>

  <div class="admin-content">
    <!-- Formulario para crear/editar recado -->
    <div class="form-section">
      <h2>{{ editingBanner ? 'Editar Recado' : 'Nuevo Recado' }}</h2>
      <form (ngSubmit)="saveBanner()" class="banner-form">
        <div class="form-group">
          <label for="title">Título del Recado *</label>
          <input 
            type="text" 
            id="title" 
            [(ngModel)]="currentBanner.title" 
            name="title"
            required
            placeholder="Ej: Recolección de Basura">
        </div>

        <div class="form-group">
          <label for="description">Mensaje o Descripción *</label>
          <textarea 
            id="description" 
            [(ngModel)]="currentBanner.description" 
            name="description"
            required
            rows="4"
            placeholder="Ej: El jueves pasa la basura. Favor de sacar los botes antes de las 8:00 AM"></textarea>
        </div>

        <div class="form-group">
          <label for="cta_text">Texto adicional (opcional)</label>
          <input 
            type="text" 
            id="cta_text" 
            [(ngModel)]="currentBanner.cta_text" 
            name="cta_text"
            placeholder="Ej: Junta de colonos el viernes">
        </div>

        <div class="form-group">
          <label for="order">Orden de visualización</label>
          <input 
            type="number" 
            id="order" 
            [(ngModel)]="currentBanner.order" 
            name="order"
            min="0"
            placeholder="0">
        </div>

        <div class="form-group checkbox-group">
          <label>
            <input 
              type="checkbox" 
              [(ngModel)]="currentBanner.is_active" 
              name="is_active"
              [checked]="currentBanner.is_active !== false">
            <span>Recado activo (visible para residentes)</span>
          </label>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-save">{{ editingBanner ? 'Actualizar' : 'Crear' }}</button>
          <button type="button" class="btn-cancel" (click)="cancelEdit()" *ngIf="editingBanner">Cancelar</button>
        </div>
      </form>
    </div>

    <!-- Lista de recados -->
    <div class="banners-section">
      <div class="section-header">
        <h2>Recados Existentes</h2>
        <span class="banner-count">{{ banners.length }} recado{{ banners.length !== 1 ? 's' : '' }}</span>
      </div>
      <div class="loading-state" *ngIf="loadingBanners">
        <p>Cargando recados...</p>
      </div>
      <div class="table-container" *ngIf="!loadingBanners && banners.length > 0; else noBanners">
        <table class="banners-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Título</th>
              <th>Descripción</th>
              <th>Texto Adicional</th>
              <th>Orden</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let banner of banners; let i = index" [class.inactive-row]="!banner.is_active">
              <td class="col-number">{{ i + 1 }}</td>
              <td class="col-title">{{ banner.title }}</td>
              <td class="col-description">{{ banner.description }}</td>
              <td class="col-cta">{{ banner.cta_text || '-' }}</td>
              <td class="col-order">{{ banner.order || 0 }}</td>
              <td class="col-status">
                <span class="status-badge" [class.active]="banner.is_active" [class.inactive]="!banner.is_active">
                  {{ banner.is_active ? 'Activo' : 'Inactivo' }}
                </span>
              </td>
              <td class="col-actions">
                <button class="btn-action btn-edit" (click)="editBanner(banner)" title="Editar recado">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                  </svg>
                </button>
                <button 
                  class="btn-action btn-toggle" 
                  [class.activate]="!banner.is_active"
                  [class.deactivate]="banner.is_active"
                  (click)="toggleBannerStatus(banner)"
                  [title]="banner.is_active ? 'Desactivar' : 'Activar'">
                  <svg *ngIf="banner.is_active" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"></path>
                  </svg>
                  <svg *ngIf="!banner.is_active" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                </button>
                <button class="btn-action btn-delete" (click)="deleteBanner(banner.id!, banner.title)" title="Eliminar recado">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  </svg>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <ng-template #noBanners>
        <div class="empty-state" *ngIf="!loadingBanners">
          <p>No hay recados creados. Crea uno nuevo usando el formulario de arriba.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>


