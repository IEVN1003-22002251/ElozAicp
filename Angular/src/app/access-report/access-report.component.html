<div class="access-report-container">
  <!-- Header -->
  <header class="report-header">
    <h1 class="report-title">Reporte de Accesos</h1>
    <button class="btn-back-report" (click)="goBack()">← Volver</button>
  </header>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Cargando datos...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!loading" class="report-content">
    <!-- Empty State -->
    <div *ngIf="totalAccesses === 0" class="empty-state">
      <div class="empty-icon">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M9 11l3 3L22 4"></path>
          <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
        </svg>
      </div>
      <p class="empty-title">No hay accesos registrados</p>
      <p class="empty-message">Los accesos aparecerán aquí cuando se registren en el sistema.</p>
    </div>

    <!-- Content with Data -->
    <div *ngIf="allVisitors.length > 0">
      <!-- Filters Container -->
      <div class="filters-container">
        <!-- Period Filter -->
        <div class="filter-section">
          <label class="filter-label">Filtrar por período:</label>
          <div class="filter-buttons">
            <button 
              class="filter-btn" 
              [class.active]="selectedPeriod === 'all'"
              (click)="setPeriod('all')">
              Todos
            </button>
            <button 
              class="filter-btn" 
              [class.active]="selectedPeriod === 'day'"
              (click)="setPeriod('day')">
              Hoy
            </button>
            <button 
              class="filter-btn" 
              [class.active]="selectedPeriod === 'month'"
              (click)="setPeriod('month')">
              Este Mes
            </button>
            <button 
              class="filter-btn" 
              [class.active]="selectedPeriod === 'year'"
              (click)="setPeriod('year')">
              Este Año
            </button>
          </div>
        </div>

        <!-- Type Filter -->
        <div class="filter-section">
          <label class="filter-label">Filtrar por tipo:</label>
          <div class="filter-buttons">
            <button 
              class="filter-btn filter-btn-all" 
              [class.active]="selectedType === 'all'"
              (click)="setType('all')">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
              </svg>
              <span>Todos</span>
            </button>
            <button 
              class="filter-btn filter-btn-visitors" 
              [class.active]="selectedType === 'visitors'"
              (click)="setType('visitors')">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              <span>Visitantes</span>
            </button>
            <button 
              class="filter-btn filter-btn-providers" 
              [class.active]="selectedType === 'providers'"
              (click)="setType('providers')">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
              </svg>
              <span>Proveedores</span>
            </button>
            <button 
              class="filter-btn filter-btn-events" 
              [class.active]="selectedType === 'events'"
              (click)="setType('events')">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
              </svg>
              <span>Eventos</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Charts Container -->
      <div class="charts-container" *ngIf="pieChartData.labels && pieChartData.labels.length > 0">
        <!-- Pie Chart -->
        <div class="chart-card">
          <h2 class="chart-title">Distribución de Accesos</h2>
          <div class="chart-wrapper">
            <canvas baseChart
              [data]="pieChartData"
              [type]="pieChartType"
              [options]="pieChartOptions"
              [legend]="true">
            </canvas>
          </div>
        </div>

        <!-- Bar Chart -->
        <div class="chart-card">
          <h2 class="chart-title">Cantidad por Tipo</h2>
          <div class="chart-wrapper">
            <canvas baseChart
              [data]="barChartData"
              [type]="barChartType"
              [options]="barChartOptions"
              [legend]="true">
            </canvas>
          </div>
        </div>
      </div>
      
      <!-- Mensaje si no hay datos para la gráfica pero hay accesos -->
      <div *ngIf="totalAccesses > 0 && (!pieChartData.labels || pieChartData.labels.length === 0)" class="no-chart-message">
        <p>No se pudieron agrupar los datos por tipo de acceso.</p>
      </div>
    </div>
  </div>
</div>


